<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Wordcharge</title>
<link rel="stylesheet" href="css/main-trnsl.css">
<script src="js/jquery.min.js"></script>
<script>
//Get the lang and text variables from URL
function getURLParameter(name) {
  return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,""])[1].replace(/\+/g, '%20'))||null
}
lang_var = getURLParameter('lang');
text_var = getURLParameter('text');

dict_key = 'dict.1.1.20140101T191051Z.9249b28df324056a.b4ed43cbaf5d80c24126112974e44172c430157d';
trnsl_key = 'trnsl.1.1.20140213T084832Z.2e599cd43e74002d.d935bc98da1909103ec212bc9ce71adeaac9de4a';
dict_api = 'https://dictionary.yandex.net/api/v1/dicservice.json/lookup';
trnsl_api = 'https://translate.yandex.net/api/v1.5/tr.json/translate';

$(document).ready(function () {
     $.ajax({ 
        type: 'GET', 
        url: trnsl_api + "?key=" + trnsl_key +"&lang="+ lang_var  +"&format=html&text=" + text_var + "",
        dataType:'json',
        success: function (data) { 
        	$("#myTransl_lang").html(data.lang);
        	$("#myTransl_text").html(data.text);

        }
    });
    
    $.ajax({ 
        type: 'GET', 
        url: dict_api + "?key=" + dict_key +"&lang="+ lang_var  +"&format=html&text=" + text_var + "",
        dataType:'json',
        //data: { get_param: 'value' }, 
        success: function (data) { 
        
        	$("#myPos").append("<table>");
        	$("#myDict").append("<tr><td>" + data.def[0].text + "</td></tr>");
        	$("#myDict").append("<tr><td>" + "[" + data.def[0].ts + "]" + "</td></tr>");
        	$("#myDict").append("<tr><td><i>(" + data.def[0].pos + ")</i></td></tr>");
        	
        	$.each(data['def'], function(i, element) {
        		//$("#myDict").append("<tr><td>" + element.text + "</td></tr>");
        		//$("#myDict").append("<tr><td>" + "[" + element.ts + "]" + "</td></tr>");
        		//$("#myDict").append("<tr><td><i>(" + element.pos + ")</i></td></tr>");
        		//$("#myDict").append("<br/>");
        		
        		$.each(element['tr'], function(i, element_tr) {
        			$("#myDict").append("<tr><td><b>" + element_tr.text + "</b></td></tr>");
        			//$("#myDict").append("<tr><td><i>(" + element_tr.pos + ")</i></td></tr>");
	        		//$("#myDict").append("<tr><td>" + element_tr.text + "</td><td> -> </td><td>(" + element_tr.pos + ")</td></tr>");
        		});
        		
        		//$("#myDict").append("<p>+++</p>");
        		
        	});
        	
        	$("#myPos").append("</table>");
        	//$("#myDict").html(data.def[0].text);

        }
    });
    
    
});
</script>
</head>
<body>
<div id="header"> </div>
<div id="wrapper">
  <div id="wrapper-headlang"> <a href="index.html" id="lng">RU</a><a href="wordchargeen.html" id="lng">EN</a></div>
  <header id="top">
    <h1>Wordcharge</h1>
  </header>
  
  <!--<article id="empty"> </article>--> 
  <!--<article id="main"></article>--> 
  <br/>
  <br/>
  <div id="myTransl_lang"></div>
  <br/>
  <div id="myTransl_text"></div>
  <br/>
  <div id="myDict"> </div>
  <br/>
  <div id="myPos"> </div>
  <br/>
  <footer>
    <p> Copyright &copy; 2014 <a href="mailto:sergibondarenko@gmail.com">Sergey Bondarenko</a> </p>
    <p><a href=http://api.yandex.ru/dictionary/>Powered by Yandex.Dictionary</a> </p>
  </footer>
</div>
</body>
</html>
